# Application Details

## **Application metadata**
> Application Name: Camera app
> package name: com.
> version code: 12
> version name: 1.2.8
> Hash: 72b4a77cd28f4fcd344cb5fb6888b5db

## **Classification**
Based on the data in **Analysis** section, the app can be considered as __Toll Fraud__

#### **Description: Toll Fraud**
Code that tricks users into subscribing to or purchasing content via their mobile phone bill. Toll Fraud includes any type of billing except premium SMS and premium calls.  
Examples of this include direct carrier billing, wireless access point (WAP), and mobile airtime transfer. WAP fraud is one of the most prevalent types of Toll fraud. WAP fraud can include tricking users to click a button on a silently loaded, transparent WebView. Upon performing the action, a recurring subscription is initiated, and the confirmation SMS or email is often hijacked to prevent users from noticing the financial transaction.

For the app to execute __toll fraud__ functionality, the phone should be in cellular data mode and the app should have the permission (`RECEIVE_SMS` or `BIND_NOTIFICATION_LISTENER`) to read the OTP during WAP subscription

## **Analysis**
This section contains a thorough analysis of the target application. A mixture of static and dynamic analysis techniques has been performed in order to investigate the application's behavior and conclude the application as malicious.

The application is analyzed using __apktool__ and __jadx__.

### **Architecture**
The application is developed using __Java__. And the main part of the code is found under `com.wevedarkrig` after decompiling it. 

The application also has native libraries for `armeabi-v7a` and `arm64-v8`, and libraries are:
- `libimg_ps.so`
- `libNativeImageProcessor.so`
- `libpanorenderer.so`
- `libpano_video_renderer.so`
- `libpl_droidsonroids_gif.so`
- `librsjni_androidx.so`
- `librsjni.so`
- `libRSSupport.so`
- `libyuv-decoder.so`

### **Permissions and Capabilities**
As specified in `AndroidManifest.xml`, the application has dangerous [permissions](./screenshots/permissions.png) and components to perform the malicious activity

#### **Permissions**
- `android.permission.ACCESS_NETWORK_STATE`
- `android.permission.ACCESS_WIFI_STATE`
- `android.permission.CAMERA`
- `android.permission.CHANGE_WIFI_STATE`
- `android.permission.INTERNET`
- `android.permission.READ_EXTERNAL_STORAGE`
- `android.permission.RECORD_AUDIO`
- `android.permission.SET_WALLPAPER`
- `android.permission.USE_FINGERPRINT`
- `android.permission.VIBRATE`
- `android.permission.WAKE_LOCK`
- `android.permission.WRITE_EXTERNAL_STORAGE`
- `com.google.android.c2dm.permission.RECEIVE`

#### **Capabilities**
- `android.permission.BIND_NOTIFICATION_LISTENER_SERVICE` - class: `com.wevedarkrig.radersten.pro.vertyl.NationService`

For __toll fraud__ to execute the application simply requires `INTERNET` permission, but this app has 
- `android.permission.CHANGE_WIFI_STATE` -  for changing the device to cellular data
- `android.permission.BIND_NOTIFICATION_LISTENER_SERVICE` - for reading the otp send to the device from notifications.

### **Static Analysis**

#### **Application Entry points**

- `com.wevedarkrig.radersten.pro.App`- **application subclass**
- `com.wevedarkrig.radersten.pro.activities.CameraMainActivity` - **launcher activity**
- `com.wevedarkrig.radersten.pro.vertyl.NationService` - **Bind notification listener service**

These are the relevant entry point classes.

##### **Application Subclass**
The application has a custom application class: `com.wevedarkrig.radersten.pro.App`, which extends `android.app.Application` and it is the code which will executed when the app starts. Initial configurations for the application are performed on this class

<p align="center">
    <img src="./screenshots/static/2.png" />
    <br/>
    <strong>Image 2.png:</strong> Declaration of application subclass in AndroidManifest.
</p>

On inspecting the class, it has code for initializing app configurations such as initializing `AdManager`, initializing `Firebase` classes etc.

- [onCreate](./screenshots/static/3.png)

##### **Launcher Activity**
The launcher activty: `com.wevedarkrig.radersten.pro.activities.CameraMainActivity` is the activity which will be executed and shown to the user when the user clicks on the icon of the application. The launcher activity is determined by activity's intent filter action `android.intent.action.MAIN` and category `android.intent.category.LAUNCHER` as we can see in image: __4.png__

<p align="center">
    <img src="./screenshots/static/4.png" />
    <br/>
    <strong>Image 4.png:</strong> Declaration of launcher activity in AndroidManifest.
</p>

The starting function, `onCreate` of the activity, initailizes a set of `TextView` widgets and intializes click listeners for the widgets, invokes a function **startlaunch()** and then checks for `CAMERA` permission and if the permission is enabled `CameraPreviewActivity` is started.

<p align="center">
    <img src="./screenshots/static/5.png" />
    <br/>
    <strong>Image 5.png:</strong> onCreate function.
</p>

**startlaunch()**
In this function, there is code to create instance of `deeplthy` and invokes getFIxer()

<p align="center">
    <img src="./screenshots/static/6.png" />
    <br/>
    <strong>Image 6.png:</strong> startlaunch() function.
</p>



